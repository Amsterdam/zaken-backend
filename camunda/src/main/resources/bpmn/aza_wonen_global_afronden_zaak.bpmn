<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.9.0" camunda:diagramRelationId="6d07ce36-1890-416e-80d5-ef7d3d02a12b">
  <bpmn:collaboration id="Collaboration_1ke9ri3">
    <bpmn:participant id="Participant_0ga994p" name="Afronden Zaak" processRef="aza_wonen_global_afronden_zaak" />
  </bpmn:collaboration>
  <bpmn:process id="aza_wonen_global_afronden_zaak" name="Afronden Zaak - Zaak Wonen" isExecutable="true" camunda:versionTag="0.0.3">
    <bpmn:laneSet id="LaneSet_0a529i3">
      <bpmn:lane id="lane_projecthandhaver_0xuwjmr" name="Projecthandhaver">
        <bpmn:flowNodeRef>task_set_next_step</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>service_end_status_1sthaq7</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>start_1qt4hub</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>gateway_close_case_or_recheck</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>service_status_next_step</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>close_0qd8zmm</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>script_set_hercontrole</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="lane_projectmedewerker_0mz4i2j" name="Projectmedewerker">
        <bpmn:flowNodeRef>service_end_status_106zrp9</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>task_close_case</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>service_status_close_case</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>close_04zl50i</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:sequenceFlow id="Flow_1v0j7yk" name="Hercontrole" sourceRef="gateway_close_case_or_recheck" targetRef="script_set_hercontrole">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${next_step=="hercontrole"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1wqsk3u" name="Afsluiten zaak" sourceRef="gateway_close_case_or_recheck" targetRef="service_status_close_case">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${next_step=="sluiten"}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0kd2iyb" sourceRef="task_set_next_step" targetRef="service_end_status_1sthaq7" />
    <bpmn:sequenceFlow id="Flow_0yfly65" sourceRef="service_end_status_1sthaq7" targetRef="gateway_close_case_or_recheck" />
    <bpmn:userTask id="task_set_next_step" name="Uitzetten vervolgstap" camunda:formKey="uitzetten_vervolgstap_form" camunda:candidateGroups="Projecthandhaver">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="next_step" label="Wat is de volgende stap voor deze zaak?" type="enum">
            <camunda:value id="hercontrole" name="Inplannen hercontrole" />
            <camunda:value id="sluiten" name="Afsluiten zaak" />
          </camunda:formField>
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1s97xge</bpmn:incoming>
      <bpmn:outgoing>Flow_0kd2iyb</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="service_end_status_1sthaq7" name="Status Beëindigen">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="payload">{
"state_identification": "${state_identification}"
}</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="content-type">application/json</camunda:entry>
                <camunda:entry key="Authorization">${zaken_access_token}</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="url">${endpoint}/api/v1/camunda/worker/end-state/</camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0kd2iyb</bpmn:incoming>
      <bpmn:incoming>Flow_0kd2iyb</bpmn:incoming>
      <bpmn:outgoing>Flow_0yfly65</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_0e6gl5c" sourceRef="start_1qt4hub" targetRef="service_status_next_step" />
    <bpmn:startEvent id="start_1qt4hub">
      <bpmn:outgoing>Flow_0e6gl5c</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:exclusiveGateway id="gateway_close_case_or_recheck" name="Hercontrole of afsluiten zaak?">
      <bpmn:incoming>Flow_0yfly65</bpmn:incoming>
      <bpmn:outgoing>Flow_1wqsk3u</bpmn:outgoing>
      <bpmn:outgoing>Flow_1v0j7yk</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="service_end_status_106zrp9" name="Status Beëindigen">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="payload">{
"state_identification": "${state_identification}"
}</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="content-type">application/json</camunda:entry>
                <camunda:entry key="Authorization">${zaken_access_token}</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="url">${endpoint}/api/v1/camunda/worker/end-state/</camunda:inputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0dcdsq9</bpmn:incoming>
      <bpmn:outgoing>Flow_1m3y02q</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="task_close_case" name="Afsluiten zaak" camunda:candidateGroups="Projectmedewerker" camunda:dueDate="${dateTime().toDate()}">
      <bpmn:incoming>Flow_1vtkvzt</bpmn:incoming>
      <bpmn:outgoing>Flow_0dcdsq9</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="service_status_close_case" name="Status Bijwerken: &#39;Afsluiten zaak&#39;" camunda:asyncBefore="true">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="payload">{
"state": "Afsluiten zaak",
"case_identification": "${case_identification}",
"case_process_id": "${execution.getProcessInstanceId()}"
}</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="content-type">application/json</camunda:entry>
                <camunda:entry key="Authorization">${zaken_access_token}</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="url">${endpoint}/api/v1/camunda/worker/state/</camunda:inputParameter>
            <camunda:outputParameter name="state_identification">${response}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1wqsk3u</bpmn:incoming>
      <bpmn:outgoing>Flow_1vtkvzt</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="close_04zl50i">
      <bpmn:incoming>Flow_1m3y02q</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0dcdsq9" sourceRef="task_close_case" targetRef="service_end_status_106zrp9" />
    <bpmn:sequenceFlow id="Flow_1m3y02q" sourceRef="service_end_status_106zrp9" targetRef="close_04zl50i" />
    <bpmn:sequenceFlow id="Flow_1vtkvzt" sourceRef="service_status_close_case" targetRef="task_close_case" />
    <bpmn:serviceTask id="service_status_next_step" name="Status Bijwerken: &#39;Vervolgstap&#39;" camunda:asyncBefore="true">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="payload">{
"state": "Vervolgstap",
"case_identification": "${case_identification}",
"case_process_id": "${execution.getProcessInstanceId()}"
}</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="content-type">application/json</camunda:entry>
                <camunda:entry key="Authorization">${zaken_access_token}</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="url">${endpoint}/api/v1/camunda/worker/state/</camunda:inputParameter>
            <camunda:outputParameter name="state_identification">${response}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0e6gl5c</bpmn:incoming>
      <bpmn:outgoing>Flow_1s97xge</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1s97xge" sourceRef="service_status_next_step" targetRef="task_set_next_step" />
    <bpmn:endEvent id="close_0qd8zmm" name="Start visit als hercontrole">
      <bpmn:incoming>Flow_1kcjkr5</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:scriptTask id="script_set_hercontrole" name="Set hercontrole= hercontrole" scriptFormat="groovy">
      <bpmn:incoming>Flow_1v0j7yk</bpmn:incoming>
      <bpmn:outgoing>Flow_1kcjkr5</bpmn:outgoing>
      <bpmn:script>execution.setVariable('hercontrole', 'hercontrole');</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_1kcjkr5" sourceRef="script_set_hercontrole" targetRef="close_0qd8zmm" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1ke9ri3">
      <bpmndi:BPMNShape id="Participant_0ga994p_di" bpmnElement="Participant_0ga994p" isHorizontal="true">
        <dc:Bounds x="160" y="50" width="1250" height="370" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_0mz4i2j_di" bpmnElement="lane_projectmedewerker_0mz4i2j" isHorizontal="true">
        <dc:Bounds x="190" y="250" width="1220" height="170" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_0xuwjmr_di" bpmnElement="lane_projecthandhaver_0xuwjmr" isHorizontal="true">
        <dc:Bounds x="190" y="50" width="1220" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1kcjkr5_di" bpmnElement="Flow_1kcjkr5">
        <di:waypoint x="1240" y="140" />
        <di:waypoint x="1282" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1s97xge_di" bpmnElement="Flow_1s97xge">
        <di:waypoint x="425" y="140" />
        <di:waypoint x="450" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1vtkvzt_di" bpmnElement="Flow_1vtkvzt">
        <di:waypoint x="980" y="330" />
        <di:waypoint x="1010" y="330" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1m3y02q_di" bpmnElement="Flow_1m3y02q">
        <di:waypoint x="1240" y="330" />
        <di:waypoint x="1282" y="330" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0dcdsq9_di" bpmnElement="Flow_0dcdsq9">
        <di:waypoint x="1110" y="330" />
        <di:waypoint x="1140" y="330" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0e6gl5c_di" bpmnElement="Flow_0e6gl5c">
        <di:waypoint x="298" y="140" />
        <di:waypoint x="325" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0yfly65_di" bpmnElement="Flow_0yfly65">
        <di:waypoint x="680" y="140" />
        <di:waypoint x="775" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0kd2iyb_di" bpmnElement="Flow_0kd2iyb">
        <di:waypoint x="550" y="140" />
        <di:waypoint x="580" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1wqsk3u_di" bpmnElement="Flow_1wqsk3u">
        <di:waypoint x="800" y="165" />
        <di:waypoint x="800" y="330" />
        <di:waypoint x="880" y="330" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="805" y="212" width="69" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1v0j7yk_di" bpmnElement="Flow_1v0j7yk">
        <di:waypoint x="825" y="140" />
        <di:waypoint x="1140" y="140" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="916" y="103" width="57" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_1vhbcm6_di" bpmnElement="task_set_next_step">
        <dc:Bounds x="450" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1sthaq7_di" bpmnElement="service_end_status_1sthaq7">
        <dc:Bounds x="580" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1qt4hub_di" bpmnElement="start_1qt4hub">
        <dc:Bounds x="262" y="122" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0u2w0m2_di" bpmnElement="gateway_close_case_or_recheck" isMarkerVisible="true">
        <dc:Bounds x="775" y="115" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="763" y="78" width="74" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_106zrp9_di" bpmnElement="service_end_status_106zrp9">
        <dc:Bounds x="1140" y="290" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_164qalf_di" bpmnElement="task_close_case">
        <dc:Bounds x="1010" y="290" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1qdco51_di" bpmnElement="service_status_close_case">
        <dc:Bounds x="880" y="290" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_04zl50i_di" bpmnElement="close_04zl50i">
        <dc:Bounds x="1282" y="312" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1d5f6nn_di" bpmnElement="service_status_next_step">
        <dc:Bounds x="325" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0ky5x91_di" bpmnElement="close_0qd8zmm">
        <dc:Bounds x="1282" y="122" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1269" y="165" width="63" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1o4l09u_di" bpmnElement="script_set_hercontrole">
        <dc:Bounds x="1140" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
